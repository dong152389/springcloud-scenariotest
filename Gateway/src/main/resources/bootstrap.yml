spring:
  cloud:
    gateway:
      routes:
        - id: service1
          uri: lb://service1
          predicates:
            - Path=/service1/**
          filters:
            - RewritePath=/service1/?(?<segment>.*), /$\{segment}
            # - name: Retry
            #   args:
            #     retries: 3
            #     statuses: NOT_FOUND
            #     methods: GET,POST
            #     backoff:
            #       firstBackoff: 10ms
            #       maxBackoff: 50ms
            #       factor: 2
            #       basedOnPreviousValue: false
            - name: RequestRateLimiter
              args:
                # 定义了每秒允许多少个请求（不含任何放弃请求）。这就是令牌桶被填满的速度。
                redis-rate-limiter.replenishRate: 2
                # 单个用户在一秒钟内允许的最大请求数（不包括放弃请求）。这是令牌桶可容纳的令牌数量。将该值设为零会阻止所有请求
                redis-rate-limiter.burstCapacity: 4
                # 表示一个请求需要多少token。这是每次请求从token桶中取出的token数量
                redis-rate-limiter.requestedTokens: 2
                key-resolver: "#{@userKeyResolver}"
  data:
    redis:
      host: 192.168.25.10
      port: 6379
      password: 111111
